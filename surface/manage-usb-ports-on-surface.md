---
title: Manage USB ports on Surface devices
description: This article explains how to secure and manage USB-C and USB-A ports on Surface devices 
ms.prod: surface
ms.localizationpriority: medium
author: coveminer
ms.author: chauncel
ms.topic: how-to
ms.date: 10/18/2023
ms.reviewer: dashap
manager: frankbu
appliesto:
- Windows 10
- Windows 11
---

# Manage USB ports on Surface devices

With USB port functionality enabled by default on Surface devices, many devices with Surface UEFI allow admins to disable connectivity to USB ports. For example, you may wish to prevent users from copying data from USB thumb drives or external hard disks.

## Get started

- IT admins can perform many USB and related port management tasks using the Surface UEFI Configurator tool to prepare .msi packages for deployment to Surface devices. Go to Manage ports via UEFI Configurator on this page. 
- Alternatively, for the most advanced scenarios, you can modify downloadable Powershell scripts for deployment to target devices via Microsoft Configuration Manager. To to Manage ports via Powershell on this page. 

## Manage ports via UEFI Configurator

See [Secure Surface Dock Ports](secure-surface-dock-ports-semm.md).

## Manage ports via Powershell

You can use PowerShell to granularly manage the functionality of USB-C ports and disable USB-A. See [Table 1](#table-1-usb-port-management-options-for-surface-devices) below for a reference of available settings across Surface devices.

For USB-A ports supporting USB2 and USB3, you can disable the USB data protocol from the USB controller to prevent all functionality.

Managing USB-C ports with their support for DisplayPort and USB Power Delivery provides more options beyond disabling all functionality. For example, you can prevent data connectivity to stop users from copying data from USB storage but retain the ability to extend displays and charge the device via a USB-C dock.

Beginning with Surface Pro 8, Surface Laptop Studio, and Surface Go 3, both of these options are now available via the SEMM PowerShell scripts.



1. Go to [Surface Tools for IT](https://www.microsoft.com/download/details.aspx?id=46703) and download **SEMM_PowerShell.zip**.

2. If you don't already have your own certificates, you can obtain certificates via the appropriate sample script: 

- **CreateSurfaceDock2Certificates.ps1**
- **CreateSurfaceThunderbolt(TM)4DockCertificates.ps1**

### Provisioning Surface docks

1. Use the appropriate provisioning script: 

- **ConfigureSEMM - Thunderbolt(TM)4Dock-Provisioning**

2. Open **ConfigureSEMM.ps1** and modify as appropriate.
3. (JK edit note: What other guidance to provide here, regarding the other scripts)
3. To disable both USB-A and USB-C ports: For UsbPortSettingType, enable the following setting: **UsbPortHwDisabled.**

**Additional options for USB-C ports:**

1. Run **ConfigureSEMM.ps1** and modify as appropriate.
2. To turn off data only and continue to use USB-C ports for power and display functionality, enable the following mode:  **Mode 1 – Data Disabled.**
3. To turn off data, power, and display functionality, enable the following mode:  **Mode 2 – Fully Disabled.**

### Table 1. USB port management options for Surface devices

| Device                                                                                                                                                                   | USB-A options                     | USB-C options                                                                                                                                                  | Settings                                                                   | SEMM IDs |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | --------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------- | -------- |
| **Surface Laptop**<br> **Surface Laptop 2**<br>**Surface Pro**<br>**Surface Pro 4**<br>**Surface Pro 6**<br>**Surface Studio**<br> **Surface Studio 2**<br>  | Enable or disable data            | N/A: No USB-C port on device                                                                                                                                   | USBPortEnabled (default)<br><br> USBPortHWDisabled                          | 370-379  |
| **Surface Laptop SE**<br>**Surface Pro 7**<br>**Surface Pro 7+**<br>**Surface Go**<br>**Surface Go 2**<br>**Surface Laptop Go**<br>**Surface Laptop Go 2**<br> **Surface Laptop Go 3**<br>**Surface Laptop 3** (Intel only)<br>**Surface Laptop 4** (Intel only)<br>**Surface Laptop 5** (Intel only)<br> **Surface Studio 2+**| Enable or disable data            |  Enabled data, display out, and power delivery<br><br>Disabled data, display out, and power delivery                                                            |  USBPortEnabled (default)<br><br>USBPortHWDisabled                          | 370-379  |
| **Surface Pro 8**<br> **Surface Pro 9**<br>**Surface Laptop Studio**<br>**Surface Laptop Studio 2**<br>**Surface Go 3**<br> **Surface Go 4**<br>                                                                                                        | Enable or disable data      | Enabled data, display-out, and  power delivery<br><br>Disabled data but enabled display-out and power delivery<br><br>Disabled data, display-out, and power delivery | UsbPortEnabled (default)<br>UsbPortDataDisabled<br>UsbPortHwDisabled | 380-389  |
| **Surface Laptop Studio 2**                                                                                                       | Enable or disable data      | Enabled data, display-out, and  power delivery<br><br>Disabled data but enabled display-out and power delivery<br><br>Disabled data, display-out, and power delivery<br><br>Data dynamically enabled or disabled | UsbPortEnabled (default)<br>UsbPortDataDisabled<br>UsbPortHwDisabled<br> UsbPortAuthenticated | 380-389  |
| **Surface Book 2** and later <br>                                                                                                                        | Base USB ports are always enabled | Base USB ports are always enabled                                                                                                                              | n/a                                                                        |          |
| **Surface Book** with Perforwmance Base<br>**Surface Book**                                                                                                               | Base USB ports are always enabled | N/A: No USB-C port on device                                                                                                                                   | n/a                                                                        |          |

 
## Dynamic USB-C disablement: Surface Laptop Studio 2

USB-C disablement is a new feature that enables customers operating in highly secure work environments to prevent USB theft of confidential data and provide more control to organizations. When paired with the Surface Thunderbolt 4 Dock,  IT admins can use certificate-based security to lock down USB-C ports whenever Surface Laptop Studio 2 is undocked or connected to an unauthorized dock. This means that when your users are connected to an authorized dock in the office, the USB-C ports will have full functionality over their devices. However, when they go off-site, they can still connect to a dock to use accessories or a monitor but cannot use the USB ports to transfer data. 

### What's new with dynamic USB-C disablement

Dynamic USB-C disablement provides IT admins with the flexibility to manage devices outside the constraints of traditional SEMM modes. In SEMM, Mode 0 and Mode 1 refer to the two operational modes:
 
1. **Mode 0 (Deployment Mode):**
   - This is the default mode when SEMM is not configured.
   - In this mode, all firmware settings are available to the user, and there are no restrictions.
   - Devices can be freely enrolled into or unenrolled from SEMM when they are in Mode 0.
 
2. **Mode 1 (Enterprise Mode):**
   - This mode is activated when a device is enrolled into SEMM using a configuration package.
   - In Enterprise Mode, the firmware settings defined by the SEMM configuration package are applied, and users cannot modify these settings.
   - To make changes to the firmware settings or to unenroll a device from SEMM, the device must be reverted to Mode 0, which requires the SEMM certificate and the appropriate tools.
 
The ability to switch between these modes provides flexibility for IT administrators. You can set up devices with the necessary restrictions for enterprise use (Mode 1) and revert to a more open configuration (Mode 0) when needed, such as during device setup, maintenance, or decommissioning. 

Dynamic USB-C disablement allows IT admins to configure Surface Laptop Studio 2 devices to switch from Mode 1 to Mode 0 without deploying a new package or restarting the device.  

In this scenario, when Surface Laptop Studio 2 is connected to an authorized Surface Thunderbolt 4 Dock, the device is subject to the firmware settings defined in SEMM. For example, IT admins can configure firmware settings as follows:
 
- Prevent users from transferring data via USB C but retain USB-C functionality to connect to an external display or power the device. This is configured by enabling **UsbPortDataDisabled** in PowerShell scripts targeted to Surface Laptop Studio 2 devices via Microsoft Configuration Manager.
- Prevent all USB-C functiontality. This is configured by enabling **UsbPortHwDisabled** in PowerShell scripts targeted to Surface Laptop Studio 2 devices via Microsoft Configuration Manager.

## Department vs organizational provisioning

Dynamic USB-C disablement allows for a many-to-many relationship between host and dock. This allows customers to have hosts and docks configured to work with all hosts/docks or make it department specific to help with asset management.   


|     Host            | Not provisioned         | Global                                                 | Department A                                        | **Department B**                                        |
| ------------------- | ----------------------- | -------------------------------------------------------  | ------------------------------------------------------- | ------------------------------------------------------- |
| **Not provisioned** | Host USB-C: Enabled     | Host USB -C: Enabled                                     | Host USB-C: Enabled                                     | Host USB-C: Enabled                                     |
| **Not provisioned** | Dock USB: Enabled       | Dock USB: Limited, based on unauthenticated dock policy  | Dock USB: Limited, based on unauthenticated dock policy | Dock USB: Limited, based on unauthenticated dock policy |
| **Global**          | Host USB-C: Disabled    | Host USB -C: Enabled                                     | Host USB-C: Enabled                                     | Host USB -C: Enabled                                    |
| **Global**          | Dock USB: Data disabled | Dock USB: Enabled                                        | Dock USB: Enabled                                       | Dock: Authenticated                                     |
| **Global**          | Host USB-C: Disabled    | Host USB-C: Enabled                                      | Host USB-C: Enabled                                     | Host USB-C: Disabled                                    |
| **Department A**    | Dock USB: Data disabled | Dock USB: Enabled                                        | Dock USB: Enabled                                       | Dock USB: Limited, based on unauthenticated dock policy |
| **Department A**    | Host USB-C: Disabled    | Host USB -C: Enabled                                     | Host USB-C: Disabled                                    | Host USB -C: Enabled                                    |
| **Department B**    | Dock USB: Data disabled | Dock USB: Enabled                                        | Dock USB: Limited, based on unauthenticated dock policy | Dock: Authenticated                                     |



## Appendix: SEMM Powershell Scripts tech reference


| Script                                                    | Purpose                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Prerequisites                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| --------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **ApplyProvisioningPackage.ps1**                          | - Demonstrates how to apply the owner and permission packages.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | - Run with administrator privileges<br><br>- Surface Device has installed the **SurfaceUEFI_Manager_(version).msi**<br><br>- Package was generated via **CreateSettingsPackage.ps1** or similar                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **ApplySettingsPackage.ps1**                              | - Demonstrates how to apply the settings package.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | - Run with administrator privileges<br><br>- Surface Device has installed the SurfaceUEFI_Manager_(version).msi<br><br>- Package was generated via CreateSettingsPackage.ps1 or similar                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **ConfigureSEMM - Dock2.ps1**                             | - Creates a Surface Dock Provisioning Package<br><br> -Applies the created provisioning package                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | - SurfaceUEFI_Manager_(version).msi has been installed<br><br>- Dock Certification Authority (DockCA) - a p7b cert, used to control ownership of a Surface Dock 2<br><br>- Dock Provisioning Certificate (ProvCert) - a pfx cert, used to sign the Dock Configuration Package with EKU 1.3.6.1.4.1.311.76.9.21.3<br><br>- This certificate and its full trust chain MUST be installed on the Surface Computer during Provisioning Package Creation to -CertStoreLocation Cert:\LocalMachine\Root<br><br>- Dock Host Authorization Certificate (HostCert) - a pfx cert, used to authorize a Surface Computer to use the authorized user dock security policies<br><br>- This certificate and its full trust chain MUST be installed on the Surface Computer during Dock Provisioning (and only this certificate) to -CertStoreLocation Cert:\LocalMachine\Root<br><br>- This certificate MUST NOT be installed on the Surface Computer during Provisioning Package Creation<br><br>- Surface Dock 2<br><br> -WMI Instance Provider for Surface Dock. To learn more, see [Manage Surface Docks with WMI](surface-dock-wmi.md)                                     |
| **ConfigureSEMM - Thunderbolt(TM)4Dock-Host-SAM.ps1**     | - Creates and applies a SEMM/DFCI package that sets the USB-C port and contains the Certificate Authority hashes<br><br>- Creates and applies a SAM Certificate Authority CFU payload                                                                                                                                                                                                                                                                                                                                                                                                       | - SurfaceUEFI_Manager_(version).msi has been installed<br><br>-  Dock Certification Authority (DockCA) - a p7b cert, used to control ownership of a Surface Dock 3<br><br>- One of the following Surface Computers (other models not yet supported): Surface Laptop Studio 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **ConfigureSEMM - Thunderbolt(TM)4Dock-Host.ps1**         | - Creates and applies a CFU packages for SAM                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | - SurfaceUEFI_Manager_(version).msi has been installed<br><br>-  A list of certificate authority files (.p7b). SAM can support up to 10 different CAs<br><br>- One of the following Surface Computers (other models not yet supported): Surface Laptop Studio 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **ConfigureSEMM - Thunderbolt(TM)4Dock-Policy.ps1**       | - Creates a Surface Thunderbolt 4 Dock policy package<br><br>- Applies the created policy package                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | - SurfaceUEFI_Manager_(version).msi has been installed<br><br>- Dock Provisioning Certificate (ProvCert) - a pfx cert, used to sign the Dock Configuration Package with EKU 1.3.6.1.4.1.311.76.9.21.3<br><br>- This certificate and its full trust chain MUST be installed on the Surface Computer during Provisioning Package Creation to -CertStoreLocation Cert:\LocalMachine\Root<br><br>- Dock Host Authorization Certificate (HostCert) - a pfx cert, used to authorize a Surface Computer to use the authorized user dock security policies<br><br>-  This certificate and its full trust chain MUST be installed on the Surface Computer during Dock Provisioning (and only this certificate) to -CertStoreLocation Cert:\LocalMachine\Root<br><br>- This certificate MUST NOT be installed on the Surface Computer during Provisioning Package Creation<br><br>- Dock Authentication Certificate (DockAuthCert)<br><br>- Surface Thunderbolt 4 Dock                                                                                                                                                                                                                                                                                                                                                                                                              |
| **ConfigureSEMM - Thunderbolt(TM)4Dock-Provisioning.ps1** | - Creates a Surface Thunderbolt 4 Dock provisioning package<br><br>- Applies the created provisioning package                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | - SurfaceUEFI_Manager_(version).msi has been installed<br><br>- Dock Certification Authority file (DepartmentCA and/or OrganizationCA) - a p7b cert, used to control ownership of a Surface Dock 3<br><br>- Dock Provisioning Certificate (ProvCert) - a pfx cert, used to sign the Dock Configuration Package with EKU 1.3.6.1.4.1.311.76.9.21.3<br><br>- This certificate and its full trust chain MUST be installed on the Surface Computer during Provisioning Package Creation to -CertStoreLocation Cert:\LocalMachine\Root<br><br>- Dock Host Authorization Certificate (HostCert) - a pfx cert, used to authorize a Surface Computer to use the authorized user dock security policies<br><br>- This certificate and its full trust chain MUST be installed on the Surface Computer during Dock Provisioning (and only this certificate) to -CertStoreLocation Cert:\LocalMachine\Root<br><br>- This certificate MUST NOT be installed on the Surface Computer during Provisioning Package Creation<br><br>- Dock Authentication Certificate (DockAuthCert)<br><br>- Surface Thunderbolt 4 Dock                                                                                                                                                                                                                                                                       |
| **ConfigureSEMM - Thunderbolt(TM)4Dock-USBC.ps1**         | - Creates and applies a USB-C Mode 3 SEMM/DFCI package                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | - SurfaceUEFI_Manager_(version).msi has been installed<br><br>- Ownership Certificate signing key has been generated and is accessible<br><br>- One of the following Surface Computers (other models not yet supported): Surface Laptop Studio 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **ConfigureSEMM.ps1**                                     | - Creates the signer provisioning (aka "owner") package and a universal reset package<br><br>- Creates a permission package<br><br>- Applies the created owner and permission packages                                                                                                                                                                                                                                                                                                                                                                                                          | - SurfaceUEFI_Manager_(version).msi has been installed<br><br>- Ownership Certificate signing key has been generated and is accessible<br><br>- Surface device with compatible SEMM-enabled UEFI                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **CreateOwnerPackage.ps1**                                | - Creates the signer provisioning (aka "owner") package and a universal reset package.<br><br>- Can run on an IT Administrator workstation (does not need to be a Surface device)                                                                                                                                                                                                                                                                                                                                                                                                           | - IT admin workstation has installed the SurfaceUEFI_Manager_(version).msi<br><br>- Ownership Certificate signing key has been generated and is accessible                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **CreateOwnerUpgradePackage.ps1**                         | - Creates the signer upgrade provisioning (aka "owner") package and a universal reset package.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | - IT admin workstation has installed the SurfaceUEFI_Manager_(version).msi<br><br>- A new ownership certificate signing key has been generated and is accessible<br><br>- An existing ownership certificate signing key has been generated and is accessible                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **CreatePermissionPackages.ps1**                          | - Demonstrates how to create a permission package.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | - IT admin workstation has installed the SurfaceUEFI_Manager_(version).msi<br><br>- Ownership Certificate signing key has been generated and is accessible                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **CreateSettingsPackage.ps1**                             | - Demonstrates how to create a settingspackage.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | - IT admin workstation has installed the SurfaceUEFI_Manager_(version).msi<br><br>- Ownership Certificate signing key has been generated and is accessible                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **CreateSurfaceDock2Certificates.ps1**                    | - Creates a set of certificates suitable for configuring a Surface Dock 2<br><br>-  They may be used in conjunction with the configure and reset scripts, or configurator                                                                                                                                                                                                                                                                                                                                                                                                                   | - N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **CreateSurfaceThunderbolt(TM)4DockCertificates.ps1**     | - Creates a set of certificates suitable for configuring a Surface Thunderbolt 4 Dock<br><br>- They may be used in conjunction with the configure and reset scripts, or configurator                                                                                                                                                                                                                                                                                                                                                                                                        | - N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **CreateTestCertificates.ps1**                            | - Demonstrates how to create the digital certificates used in the system.<br><br>- **Note:** The certificates created here will work for testing purposes but are simplistic and not recommended for actual deployment.<br><br>- We strongly recommend that you learn more about PKI Best Practices by reading topics on PKI such as the following: [Best Practices for Implementing a Microsoft Windows Server 2003 Public Key Infrastructure](/previous-versions/windows/it-pro/windows-server-2003/cc772670(v=ws.10)?)                                                                       | - N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **CurrentSettings.ps1**                                   | - Display the current SEMM settings on the device at boot.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | - Run with administrator privileges<br><br>- Surface Device has installed the SurfaceUEFI_Manager_(version).msi                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **ResetSEMM - Dock2.ps1**                                 | - Creates a Surface Dock Reset Package<br><br>- Applies the created reset package                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | - SurfaceUEFI_Manager_(version).msi has been installed<br><br>- Dock Certification Authority (DockCA) - the p7b certificate file, used to control ownership of a Surface Dock 2<br><br>- Dock Provisioning Certificate (ProvCert) - a pfx certificate file, used to sign the Dock Configuration Package with EKU 1.3.6.1.4.1.311.76.9.21.3<br><br>- This certificate and its full trust chain MUST be installed on the Surface Computer during Provisioning Package Creation to -CertStoreLocation Cert:\LocalMachine\Root<br><br>- Dock Host Authorization Certificate (HostCert) - a pfx certificate file, used to authorize a Surface Computer to use the authorized user dock security policies<br><br>- This certificate and its full trust chain MUST be installed on the Surface Computer during Dock Provisioning (and only this certificate) to -CertStoreLocation Cert:\LocalMachine\Root<br><br>- This certificate MUST NOT be installed on the Surface Computer during Provisioning Package Creation<br><br>- Surface Dock 2<br><br> - WMI Instance Provider for Surface Dock 2. To learn more, see [Manage Surface Docks with WMI](surface-dock-wmi.md).      |
| **ResetSEMM - Thunderbolt(TM)4Dock.ps1**                  | - Creates a Surface Thunderbolt 4 Dock Reset Package<br><br>- Applies the created reset package                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | - SurfaceUEFI_Manager_(version).msi has been installed<br><br>- Dock Provisioning Certificate (ProvCert) - a pfx certificate file, used to sign the Dock Configuration Package with EKU 1.3.6.1.4.1.311.76.9.21.3<br><br>- This certificate and its full trust chain MUST be installed on the Surface Computer during Provisioning Package Creation to -CertStoreLocation Cert:\LocalMachine\Root<br><br>- Dock Host Authorization Certificate (HostCert) - a pfx certificate file, used to authorize a Surface Computer to use the authorized user dock security policies<br><br>- This certificate and its full trust chain MUST be installed on the Surface Computer during Dock Provisioning (and only this certificate) to -CertStoreLocation Cert:\LocalMachine\Root<br><br>- This certificate MUST NOT be installed on the Surface Computer during Provisioning Package Creation<br><br>-  Surface Thunderbolt 4 Dock                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **ResetSemm.ps1**                                         | - Creates and applies a SEMM reset package for a specific device.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | - Administrative privileges on the device.<br><br>- Surface Device has installed the SurfaceUEFI_Manager_(version).msi<br><br>- Certificate has been generated and is accessible (and password is 1234)<br><br>- This Surface device was formerly enrolled with the same certificate                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **ShowSettingsOptions.ps1**                               | - Prints the UEFI settings that can be applied to Surface devices.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | - IT admin workstation has installed the SurfaceUEFI_Manager_(version).msi                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **VerifyDockSettings.ps1**                                | - To capture and display the current configuration of the connected Surface Dock                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | - Surface Dock 2 or Surface Thunderbolt 4 Dock<br><br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **VerifySettings.ps1**                                    | - Demonstrates how to see the current settings and state of recent updates.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | - Run with administrator privileges<br><br>- Surface Device has installed the SurfaceUEFI_Manager_(version).msi<br><br>- Packages were applied and the session ID files saved.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |

